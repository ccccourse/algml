以下是《語言模型背後的數學》中**2.2 機率與統計基礎**部分的草稿：

### 2.2 機率與統計基礎

機率與統計是理解語言模型的重要組成部分，這些概念幫助我們量化不確定性和隨機性，並用於模型的訓練和評估。本節將介紹幾個基本的機率與統計概念，並探討它們在語言模型中的應用。

#### 1. 機率的基本概念

- **機率**：機率是某事件發生的可能性，通常用介於 0 到 1 之間的數字表示。若事件發生的機率為 0，則該事件不會發生；若機率為 1，則事件必然發生。在語言模型中，我們常用機率來預測某個詞在給定上下文中的出現機率，如 \(P(w|C)\)。

- **條件機率**：條件機率是指在已知某事件發生的條件下，另一事件發生的機率。公式為：
  \[
  P(A|B) = \frac{P(A \cap B)}{P(B)}
  \]
  在語言模型中，這可以用於表示在特定上下文中某個詞的出現機率。

- **全概率公式**：當面臨多個互斥事件時，全概率公式幫助我們計算某事件的總機率。公式為：
  \[
  P(A) = \sum_{i} P(A|B_i) P(B_i)
  \]
  在語言模型中，這可以用於計算一個詞出現的總機率。

#### 2. 隨機變量

- **隨機變量**：隨機變量是取值不確定的數量，可以是離散的或連續的。離散隨機變量的取值為有限或可數無限，而連續隨機變量的取值為無窮多。在語言模型中，隨機變量可以用來表示詞的出現次數、上下文長度等。

- **概率分佈**：概率分佈描述了隨機變量所有可能取值及其相應的機率。常見的概率分佈包括：
  - **伯努利分佈**：用於表示二元事件的機率，如詞的出現與否。
  - **正態分佈**：描述連續變量的分佈，通常用於建模詞的特徵向量。

#### 3. 統計量

- **均值**：均值是隨機變量的一種集中趨勢度量，表示數據的平均水平。對於離散隨機變量，其均值計算公式為：
  \[
  \mu = E[X] = \sum_{i} x_i P(X = x_i)
  \]

- **方差**：方差是衡量數據分散程度的統計量，計算公式為：
  \[
  \sigma^2 = E[(X - \mu)^2]
  \]
  在語言模型中，方差可以幫助我們了解詞頻的變化。

- **標準差**：標準差是方差的平方根，表示數據相對於均值的散布情況。它在評估模型性能時具有重要意義。

#### 4. 機率與統計在語言模型中的應用

- **訓練模型**：在訓練過程中，我們常用最大似然估計（MLE）來計算參數，使得觀察到的數據最有可能出現。這需要計算條件機率，並根據樣本數據更新模型參數。

- **模型評估**：語言模型的性能通常使用困惑度（perplexity）等指標來評估，這些指標都與機率有關。例如，困惑度是基於模型對測試數據的預測機率計算得出的。

- **生成文本**：語言模型生成文本時，基於上下文的機率分佈決定了下個詞的選擇。這一過程依賴於對機率的計算和分析。

#### 結論

掌握機率與統計的基本概念將幫助我們理解語言模型的行為及其在自然語言處理中的應用。這些數學工具不僅用於模型的設計與訓練，還有助於模型的性能評估和優化。在接下來的章節中，我們將進一步探討線性代數的概念，並將其應用於語言模型的結構與計算中。

---

如果您有任何修改建議或希望擴展的內容，請隨時告訴我！