脈動陣列（Systolic Array）是一種特別設計的並行計算架構，用於高效處理數學運算，尤其是矩陣運算。脈動陣列的設計概念是由 H. T. Kung 和 Charles E. Leiserson 在 1970 年代提出的，這個架構成為了現代張量處理器（TPU）的基礎技術之一。

## 脈動陣列的基本概念

脈動陣列由一組定期排列的處理單元（Processing Elements, PEs）組成，這些單元以固定的方式相互通信，每個單元都可以進行簡單的算術操作，如加法或乘法。資料在陣列中以「脈動」的方式傳播，數據和結果按照一定的時間步驟在處理單元之間流動，從而實現高效的並行運算。

### 1. **處理單元的組織**
脈動陣列的每個處理單元（PE）只執行簡單的操作，但通過將這些單元組織成規則的陣列結構，整體上能高效完成複雜的矩陣運算。例如，矩陣乘法這類運算可以分解成大量的加法和乘法操作，並且在脈動陣列中這些操作可以同時進行，從而顯著提高計算效率。

### 2. **數據流的特徵**
在脈動陣列中，數據不是一次性傳遞給所有處理單元，而是「脈動」式地傳遞。輸入數據以規則的方式從一側進入，經過每個處理單元進行計算後逐步向前傳播，最終得出結果。這種設計避免了數據頻繁進出主存儲器，減少了記憶體帶寬的瓶頸。

### 3. **運算特性**
脈動陣列的設計針對固定大小的數據塊進行優化，例如矩陣中的行和列。在進行矩陣乘法時，數據從兩個矩陣的一側分別注入，處理單元負責累加結果。每個單元僅與其鄰居交換數據，這使得脈動陣列可以非常高效地並行執行計算。

## 脈動陣列的應用

### 1. **數字信號處理**
脈動陣列最早的應用之一是數字信號處理（Digital Signal Processing, DSP）。在處理信號的過程中，矩陣運算非常常見，脈動陣列能夠快速處理濾波、轉換等運算，特別適合需要高吞吐量的場景。

### 2. **矩陣乘法**
矩陣乘法是脈動陣列最典型的應用場景。在這種情況下，脈動陣列能夠同時處理矩陣的多個元素，並且避免了傳統處理器在矩陣運算中反覆訪問記憶體的瓶頸。

### 3. **科學計算與超級計算機**
在超級計算機領域，脈動陣列技術曾被廣泛應用於高效處理數學運算。其並行運算能力使其能夠處理大型科學計算問題，如求解偏微分方程、線性代數運算等。

## 脈動陣列與TPU的關聯

TPU 的核心設計基於脈動陣列架構，特別是在矩陣乘法的加速上。Google 的 TPU 使用了類似脈動陣列的架構來高效處理神經網絡中的張量運算，例如卷積運算和全連接層的矩陣運算。TPU的矩陣乘法單元（MXU）正是脈動陣列的現代化應用，它能夠在神經網絡的訓練和推理中，同時執行大量的矩陣乘法，顯著加快計算速度。

### **TPU中的MXU工作原理**
TPU內部的MXU單元可以被視為一個現代化的脈動陣列，它負責執行矩陣乘法操作。在神經網絡中，大量的運算都可以歸結為矩陣乘法，例如卷積層和全連接層。因此，通過使用類似脈動陣列的結構，TPU可以極大地提升這些操作的計算速度。

---

### 總結
脈動陣列作為一種並行計算架構，為現代深度學習加速器（如TPU）提供了重要的技術基礎。TPU通過類似脈動陣列的矩陣運算優化，能夠在神經網絡訓練和推理中提供卓越的性能。脈動陣列的設計理念，尤其是在高效處理矩陣乘法上的貢獻，成為了TPU等現代AI加速器的核心構件。