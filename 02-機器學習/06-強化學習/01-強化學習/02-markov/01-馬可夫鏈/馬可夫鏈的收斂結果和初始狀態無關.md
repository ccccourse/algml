## 馬可夫鏈 (Markov Chains)

* from -- https://ithelp.ithome.com.tw/articles/10201028

馬可夫鏈的收斂結果和初始狀態無關

Andrey Markov 是一名俄羅斯數學家，主要研究的興趣是隨機程序。馬可夫鏈是馬可夫在研究「一連串相關事件所組成的系統，會怎麼隨著時間變化」時，所提出的一個數學模型。這個模型中有以下部分：

1. 狀態集(states)：包含所有 m 種狀態
2. 初始狀態(initial state)：一開始的狀態，記作 s0
3. 轉移矩陣(transition matrix)：描述上一個狀態，是如何轉移到下一個狀態的，記作 T(s,s')

「在狀態轉移的過程中，下一個狀態只受到現在狀態的影響，與過去狀態無關」。假設現在現在一連串事件共有 n 個，以條件機率的方式描述，可以將馬可夫性質定義為 

P(Sn|Sn-1,....S0) = P(Sn|Sn-1)

![](https://i.imgur.com/KQGlwtZ.png)


## 2.1 馬可夫鏈

馬可夫鏈是一種隨機過程，它具有馬可夫性質，即當前狀態的未來發展只與當前狀態有關，與過去狀態無關。一個馬可夫鏈可以用一個有限或無限的狀態集合來表示，並且每個狀態都有一個轉移概率矩陣，表示在當前狀態下轉移到下一個狀態的概率。

在強化學習中，馬可夫鏈被廣泛用於描述智能體在不同環境狀態之間的轉移。為了方便，我們將在本書中使用有限馬可夫鏈來描述環境狀態之間的轉移。

有限馬可夫鏈由以下三個要素組成：

1. 狀態集合

有限馬可夫鏈的狀態集合表示環境中可能出現的不同狀態，通常用$S$表示。狀態集合可以是有限的，也可以是無限的。

2. 轉移概率矩陣

有限馬可夫鏈的轉移概率矩陣 $P$ 表示從一個狀態轉移到另一個狀態的概率。矩陣中的每個元素 $P_{s,s'}$ 表示當前狀態為 $s$ 時，下一個狀態為 $s'$的概率。轉移概率矩陣可以表示為：

$$P[N,N]$$

其中， $N$ 表示狀態集合中的狀態數量。

3. 初始概率分布

有限馬可夫鏈的初始概率分布表示在起始狀態時，每個狀態出現的概率。通常，初始概率分布可以表示為一個概率向量 $\pi$ ，其中 $\pi_s$ 表示初始狀態為 $s$ 的概率。

有限馬可夫鏈的動態可以表示為一個序列，其中每個狀態是從上一個狀態轉移而來的。給定一個初始狀態，我們可以根據轉移概率矩陣生成一個狀態序列。具體地，給定初始狀態 $s_0$ ，我們可以根據轉移概率矩陣 $P$ 生成狀態序列 $s_0, s_1, s_2, \cdots$ ，其中 $s_{t+1}$ 的概率為 $P_{s_t,s_{t+1}}$ 。

在強化學習中，智能體在不同狀態之間的轉移可以用馬可夫鏈來描述。智能體所處的環境可以被看作一個馬可夫鏈，智能體所採取的行動可以影響環境狀態的轉移，而環境狀態的轉移又可以影響智能體所處的環境狀態。因此，強化學習中的環境通常被描述為一個馬可夫決策過程。
