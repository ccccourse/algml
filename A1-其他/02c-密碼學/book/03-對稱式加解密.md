**第 3 章 對稱加密算法**

---

### **3.1 對稱加密基礎**

對稱加密（Symmetric Encryption）是一種加密方法，其中加密和解密使用相同的密鑰。也就是說，發送者和接收者共享一個秘密密鑰，並使用該密鑰來加密和解密數據。對稱加密的主要特點是：

- **加密與解密相同的密鑰**：加密和解密過程使用相同的密鑰。這意味著密鑰必須在通信雙方之間保密和安全地傳遞。
- **效率高**：對稱加密算法通常比非對稱加密算法更高效，尤其是在處理大量數據時。
- **密鑰管理的挑戰**：對稱加密的主要問題在於密鑰的管理和分發。若密鑰被第三方獲取，則加密系統的安全性會受到威脅。

對稱加密的一個常見應用是**文件加密**、**虛擬私人網絡（VPN）**、以及**無線通信安全**等場景。

常見的對稱加密算法包括：**DES**（Data Encryption Standard）、**AES**（Advanced Encryption Standard）等。

### **3.2 曼寧算法與 DES**

**曼寧算法**（Feistel Network）是一種對稱加密結構，它並不是一個具體的算法，而是一種加密架構。許多經典的對稱加密算法都基於這種結構，其中最著名的就是**DES**（Data Encryption Standard）算法。

#### **曼寧結構的工作原理**：
- 曼寧結構將明文分為兩個部分，並反覆進行加密和解密過程中的“交換”操作，這個過程稱為“輪迴”（Rounds）。每一輪使用不同的密鑰進行操作，並對數據進行“交換”與“混淆”。
- 曼寧結構具有很強的擴散性和混亂性，這使得密文與明文之間的關聯變得難以直接推測。

#### **DES（數據加密標準）**：
DES 是一種基於曼寧結構的對稱加密算法。它的工作原理包括：
- **密鑰長度**：DES 使用 56 位的密鑰進行加密。
- **數據塊大小**：每次處理 64 位的數據塊。
- **輪數**：DES 使用 16 輪進行加密，每一輪的操作基於密鑰的不同子集。

儘管 DES 在過去的幾十年中廣泛使用，但由於其密鑰長度較短（56 位），如今已經不再被視為安全的加密方法。現代的計算能力使得暴力破解 DES 的密鑰變得相對容易，因此 DES 被逐漸淘汰。

### **3.3 AES（高級加密標準）**

**AES**（Advanced Encryption Standard）是目前廣泛使用的對稱加密算法，它由比利時數學家 **Vincent Rijmen** 和 **Joan Daemen** 設計，並於 2001 年成為美國國家標準（FIPS 197）。

#### **AES 的主要特點**：
- **密鑰長度**：AES 支援三種密鑰長度：128 位、192 位和 256 位。較長的密鑰提供了更強的安全性。
- **數據塊大小**：AES 使用 128 位的數據塊進行加密處理。
- **輪數**：AES 根據密鑰長度進行不同數量的加密輪。對於 128 位密鑰，使用 10 輪；對於 192 位密鑰，使用 12 輪；對於 256 位密鑰，使用 14 輪。
- **操作模式**：AES 支援多種工作模式，例如 ECB（電子代碼本模式）、CBC（密文區塊鏈接模式）、CTR（計數器模式）等，每種模式有不同的加密特性和用途。

AES 的加密過程包括：
- **SubBytes**：每個字節都會通過替換操作進行混淆。
- **ShiftRows**：將每一行的字節進行移位操作，增強數據的擴散性。
- **MixColumns**：對列進行混合操作，使得數據更加難以預測。
- **AddRoundKey**：將密鑰進行異或操作，這是每一輪的操作之一。

AES 目前被廣泛應用於各種安全通信協議，如 SSL/TLS、VPN、Wi-Fi 安全等。

### **3.4 Python 實現對稱加密**

Python 提供了多個庫來實現對稱加密，最常見的庫之一是 **PyCryptodome**。這個庫支持多種對稱加密算法，包括 AES、DES、3DES 等。

#### **使用 PyCryptodome 實現 AES 加密**

```python
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
from Crypto.Random import get_random_bytes

# 生成隨機密鑰和初始化向量
key = get_random_bytes(16)  # 128 位密鑰
iv = get_random_bytes(16)   # 128 位初始化向量

# 創建 AES 加密對象
cipher = AES.new(key, AES.MODE_CBC, iv)

# 加密明文
data = b"Hello, AES encryption!"
padded_data = pad(data, AES.block_size)
encrypted_data = cipher.encrypt(padded_data)

# 創建 AES 解密對象
decipher = AES.new(key, AES.MODE_CBC, iv)

# 解密數據
decrypted_data = unpad(decipher.decrypt(encrypted_data), AES.block_size)

print(f"Encrypted: {encrypted_data}")
print(f"Decrypted: {decrypted_data.decode()}")
```

這段代碼使用了 PyCryptodome 庫來實現 AES CBC 模式的加密與解密。首先，生成隨機的密鑰和初始化向量，然後對明文進行填充並加密，最後使用相同的密鑰和初始化向量解密並還原明文。

### **3.5 密鑰管理與密碼學安全性**

對稱加密的安全性主要依賴於密鑰的保密性，因此，**密鑰管理**成為了確保加密系統安全的核心。

#### **密鑰管理的挑戰**：
- **密鑰生成**：密鑰必須由可靠的隨機數生成器產生，確保其不可預測性。
- **密鑰分發**：在對稱加密中，密鑰需要在發送者和接收者之間安全地傳遞。這通常通過安全的通道或使用公鑰加密進行密鑰交換。
- **密鑰存儲**：密鑰必須存儲在安全的位置，防止未授權的訪問。常見的做法是使用硬體安全模塊（HSM）或密鑰管理系統（KMS）。
- **密鑰輪換與過期**：為了減少長期使用同一密鑰可能帶來的風險，密鑰應該定期輪換或過期。

#### **密碼學安全性**：
- **計算能力**：現代計算機的運算能力大大提升，這使得暴力破解密碼變得更加容易。因此，對稱加密算法的安全性必須基於合理的密鑰長度。128 位密鑰通常足夠安全，而較長的密鑰（如 256 位）提供了更高的安全保障。
- **抗分析性**：密碼學安全性也依賴於算法的抗分析性，包括抗線性分析、差分分析等。

在實際應用中，對稱加密與非對稱加密（如 RSA）通常配合使用，以實現既高效又安全的數據加密。

---

這一章介紹了對稱加密算法的基礎概念、著名算法（如 DES 和 AES）的工作原理、Python 實現對稱加密的示範，以及密鑰管理在確保加密系統安全中的重要性。理解這些基本概念對於掌握密碼學的實際應用至關重要。