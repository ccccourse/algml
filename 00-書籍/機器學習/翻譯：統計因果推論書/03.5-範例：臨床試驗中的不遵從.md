### 3.5 範例：臨床試驗中的不完全遵從性

為了說明結構因果推斷方法，讓我們考慮一個典型的臨床試驗範例，其中包含部分遵從。這種情境下的治療效應通常是無法識別的，但這個例子非常適合用來說明每個因果推斷練習中的四個主要步驟：

```
1. 定義：將目標數量Q表達為可從任何模型M計算的函數Q(M)。
2. 假設：使用普通科學語言來表述因果假設，並用圖形形式表示其結構部分。
3. 識別：確定目標數量是否可識別。
4. 估計：如果目標數量可識別，則進行估計；如果不可識別，則進行近似估計。
```

### 3.5.1 定義目標數量

在我們的範例中，定義階段並未因為討論的實驗設置而改變。結構建模方法強調，在指定治療選擇過程之前，應該先定義目標數量，在我們的情況下是“因果效應”，而且不應提前對功能形式或分佈作假設。根據方程式 (7) 給出的因果效應P(y|do(x))的正式定義，這一方法是普遍適用於所有模型的，並涉及形成一個子模型 \( M_x \)。通過這樣程序化地定義因果效應，將其與傳統的參數表示脫離，結構理論避免了過去半個世紀以來困擾結構方程式和計量經濟學參數解釋的眾多混亂和爭議。

### 3.5.2 形成假設 - 工具變數

典型臨床試驗中部分遵從的實驗設置可以通過圖 5 (a) 和方程式 (5) 表示，其中 \( Z \) 表示隨機治療分配，\( X \) 是實際接受的治療，而 \( Y \) 是觀察到的反應。\( U_Y \) 項代表所有未觀察到的影響受試者對治療反應的因素；因此，從 \( U_Y \) 到 \( Y \) 畫了一條箭頭。類似地，\( U_X \) 表示所有影響受試者遵從分配的因素，而 \( U_Z \) 代表隨機設備，用於決定分配。\( U_X \) 和 \( U_Y \) 之間的依賴關係允許某些因素（例如社會經濟地位或疾病傾向）同時影響遵從性和反應。在方程式 (5) 中，\( f_X \) 表示受試者選擇治療的過程，\( f_Y \) 表示決定結果 \( Y \) 的過程。顯然，完美遵從將意味著設置 \( f_X(z, u_X) = z \)，而任何與 \( U_X \) 之間的依賴關係則代表不完全遵從。圖 5 (a) 的圖形模型反映了兩個假設：

1. 分配 \( Z \) 不直接影響 \( Y \)，而是通過實際接受的治療 \( X \) 影響。這種假設稱為“排除”限制，因為它排除了變數 \( Z \) 作為 \( f_Y \) 函數的決定性變數，如方程式 (5) 所示。
2. 變數 \( Z \) 與 \( U_Y \) 和 \( U_X \) 相互獨立；這是通過 \( Z \) 的隨機化確保的，排除了 \( Z \) 和 \( U_Y \)（以及 \( Z \) 和 \( U_X \)）之間的共同原因。

通過繪製圖 5 (a)，研究者可以明確表達這兩個假設，並允許技術分析部分開始，根據方程式 (5) 中的解釋進行。

此情境下的因果分析目標是估計治療 \( X \) 對結果 \( Y \) 的因果效應，如方程式 (6) 中的修改模型所定義，以及對應的分佈 \( P(y|do(x_0)) \)。換句話說，這個分佈描述了在一個假設實驗中，將治療 \( X = x_0 \) 均勻施加給整個人群，並讓 \( x_0 \) 在假設的人群中取不同值時的反應。檢查圖 5 (a) 可以立即發現，這個分佈無法通過調整混雜變數來識別。這樣識別的圖形標準（定義 3）要求在“背門”路徑 \( X \leftarrow U_X \leftrightarrow U_Y \rightarrow Y \) 上存在觀察到的協變數，從而阻止由這條路徑創造的虛假關聯。如果 \( U_X \)（或 \( U_Y \)）是可觀察的，則治療效應將通過在 \( U_X \) 水平上分層來獲得。

```
P(Y=y|do(x_0)) =
∑_{u_X} P(Y=y|X=x_0, U_X=u_X)P(U_X=u_X)
```

這樣可以得出一個可估計的表達式，該表達式不需要測量 \( U_Y \)，也不對 \( U_Y \) 和 \( U_X \) 之間的依賴作假設。然而，由於 \( U_X \) 和 \( U_Y \) 假定是未觀察到的，並且沒有其他阻擋協變數，研究者可以得出結論：通過調整無法消除混雜偏誤。此外，還可以證明，在缺乏額外假設的情況下，這種圖形中的治療效應無法通過任何方法識別（Balke 和 Pearl, 1997）；因此，必須採取近似方法進行評估。

### 3.5.3 限制因果效應

當識別條件無法滿足時，最佳的方法是推導出對目標量的限制——即一個表示我們對數據生成過程無知的可能值範圍，這個範圍無法通過增加樣本量來改善。在我們的例子中，這相當於對方程式 (8) 中的平均差進行限制，並遵循觀察到的分佈約束。

```
P(x, y|z) =
∑_{u_X, u_Y} P(x, y, u_X, u_Y|z)
= ∑_{u_X, u_Y} P(y|x, u_Y, u_X)P(x|z, u_X)P(u_Y, u_X)
```

同樣，因為因果效應是由圖 5 (b) 的修改模型控制的，它可以寫成：

```
P(y|do(x′)) - P(y|do(x′′)) =
∑_{u} [P(y|x′, u_Y) - P(y|x′′, u_Y)] P(u_Y)
```

我們的任務是根據方程式 (32) 中表達的觀察到的概率來限制方程式 (33) 中的表達式。這個任務等同於進行約束優化，尋找在滿足這些約束的情況下，方程式 (33) 的最大值和最小值。

### 3.5.4 工具變數的可檢驗含義

圖 5 (a) 中的模型所體現的兩個假設，即 \( Z \) 是隨機分配且對 \( Y \) 沒有直接影響，在一般情況下是無法檢驗的。然而，如果治療變數 \( X \) 只有有限個值，這兩個假設的結合可以產生可檢驗的含義，這些含義可用來警示研究者可能違反這些假設。可檢驗的含義以不等式的形式表現，限制了觀察條件分佈 \( P(x, y|z) \) 的某些方面不超過特定範圍。