### 5. Counterfactuals at Work

#### 5.1. Mediation: Direct and Indirect Effects

##### 5.1.1. 直接效應與總效應

到目前為止，我們分析的因果效應 \( P(y|do(x)) \) 測量了變數 \( X \) 對反應變數 \( Y \) 的總體效應。在許多情況下，這個數量並不能充分表現出研究的目標，因此，關注的焦點通常轉向 \( X \) 對 \( Y \) 的直接效應。所謂「直接效應」，是指不受其他變數在模型中的中介作用所影響的效應，或者更準確地說，是 \( X \) 改變時，當所有其他因素固定不變時，對 \( Y \) 的敏感度。當固定這些因素時，除了直接的 \( X \to Y \) 連接外，所有其他的因果路徑都會被切斷，這些路徑不會受到中介變數的影響。

直接效應的經典範例是有關種族或性別歧視的法律爭議，特別是在招聘過程中。在這些案件中，性別或種族對申請者資格的影響，或資格對招聘的影響並不是訴訟的目標。相反，被告必須證明性別和種族對招聘決策的影響是間接的，無論其如何影響招聘結果。

另一個例子是神經通路的識別，或者分子生物學中蛋白質信號傳遞網絡的結構特徵。在這些情境中，將效應分解為直接和間接組成部分具有理論科學意義，因為它預測了在各種假設性干預下的行為。

在所有這些例子中，要求固定中介變數必須被理解為通過物理干預將中介變數設置為常數，而不是通過分析手段，如選擇、條件或調整。例如，僅通過條件化中介變數 \( Z \) 來測量性別 \( X \) 和招聘 \( Y \) 之間的關聯是不夠的，因為這樣可能會創造出虛假的關聯，即使 \( X \) 對 \( Y \) 沒有直接效應（Pearl, 1998；Cole 和 Hernán, 2002）。這可以通過模型 \( X \to Z \leftarrow U \to Y \) 來說明，其中 \( X \) 沒有對 \( Y \) 的直接影響。通過物理固定 \( Z \)，將保持 \( X \) 和 \( Y \) 之間的獨立性，如刪除所有指向 \( Z \) 的箭頭所示。然而，如果我們對 \( Z \) 進行條件化，則可能通過未觀察到的 \( U \) 創造出虛假的聯繫，這可能會被誤認為是 \( X \) 對 \( Y \) 的直接效應。

利用 \( do(x) \) 符號，並專注於期望差異，我們可以得到控制直接效應（CDE）的簡單定義：

\[
CDE \Delta = E(Y|do(x'), do(z)) - E(Y|do(x), do(z))
\]

或者，使用反事實符號表示：

\[
CDE \Delta = E(Y_{x'z}) - E(Y_{xz}) \tag{46}
\]

這裡 \( Z \) 是任何中介變數集，這些變數會截斷 \( X \) 和 \( Y \) 之間的所有間接路徑。Pearl 和 Robins (1995) 推導了類似 \( E(Y|do(x), do(z_1), do(z_2), ..., do(z_k)) \) 的表達式的圖形識別條件（見 Pearl, 2000a，第 4 章），並使用背門條件的順序應用（定義 3）。

##### 5.1.2. 自然直接效應

在線性系統中，公式 (46) 給出了從 \( X \) 到 \( Y \) 的路徑係數；這與我們固定 \( Z \) 的數值無關，與誤差項的分佈無關，也不管這些係數是否可識別。在非線性系統中，固定 \( Z \) 的值通常會改變 \( X \) 對 \( Y \) 的效應，因此應小心選擇 \( Z \) 的值，以便代表所分析的目標政策。例如，某些雇主偏好男性擔任高薪工作（即 \( Z \) 高），女性擔任低薪工作（即 \( Z \) 低）。

當直接效應對固定 \( Z \) 的數值敏感時，通常有意義將直接效應定義為相對於“自然代表”這些數值的變化，或者更具體地說，是 \( X \) 從 \( x \) 變更為 \( x' \) 時，保持所有中介因素不變（即使它們在 \( do(x) \) 下取得的值）。這個假設性變化，Robins 和 Greenland (1992) 稱之為「純直接效應」，而 Pearl (2001) 稱之為「自然直接效應」，反映了立法者在種族或性別歧視案件中所要求的："任何招聘歧視案件中的核心問題是，雇主是否會在員工的種族（年齡、性別、宗教、國籍等）發生變化的情況下採取相同的行動，並且其他所有條件保持不變"（在 Carson 與 Bethlehem Steel Corp. 案中，70 FEP Cases 921，第 7 巡回法院，1996年）。

擴展子標籤符號以表示嵌套反事實，Pearl (2001) 給出了“自然直接效應”的定義：

\[
DEx,x' (Y) = E(Y_{x',Z_x}) - E(Y_x) \tag{47}
\]

這裡，\( Y_{x',Z_x} \) 表示當 \( X \) 設置為 \( x' \) 且 \( Z \) 設置為原來在 \( X = x \) 下的值時，\( Y \) 的值。可以看到，\( DEx,x' (Y) \) 涉及嵌套反事實的機率，無法使用 \( do(x) \) 符號表示。因此，在一般情況下，自然直接效應無法識別，即使是在理想的控制實驗下。

然而，Pearl (2001) 已經表明，如果某些“無混淆”假設被認為是有效的，則自然直接效應可以簡化為：

\[
DEx,x' (Y) = \sum_{z} \left[ E(Y|do(x', z)) - E(Y|do(x, z)) \right] P(z|do(x)) \tag{48}
\]

直觀來說，自然直接效應是控制直接效應 (46) 的加權平均，使用因果效應 \( P(z|do(x)) \) 作為加權函數。

識別公式 (47) 的一個充分條件是，對於某些已測量的協變量集 \( W \)，有 \( Z_x \perp \!\!\! \perp Y_{x'},z | W \) 的條件。然而，這個條件本身，像公式 (42) 中的可忽略性條件一樣，對大多數研究者而言幾乎是沒有意義的，因為它並未以實現變數的形式表達。這時可以調用第 4.3 節中的共生分析，通過公式 (45) 揭示這個條件的圖形解釋。該條件指出，\( W \) 應該是可接納的（即，滿足背門條件），相對於從 \( Z \) 到 \( Y \) 的路徑。