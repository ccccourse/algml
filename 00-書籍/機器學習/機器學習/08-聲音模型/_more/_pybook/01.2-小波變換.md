### 小波變換 (Wavelet Transform)

小波變換（Wavelet Transform, WT）是一種數學變換，用於分析信號中的不同尺度和時頻信息。與傅立葉變換不同，傅立葉變換將信號表示為正弦波的組合，無法提供時間信息。而小波變換則能夠同時提供信號在時間和頻率上的局部性，這使得它特別適合於分析非平穩信號，如語音信號、音頻信號和圖像信號等。

#### 1. 小波變換的基本概念

小波變換是一種基於小波函數（Wavelet Function）的變換方法。小波是具有有限支持的波形，其具有不同的尺度（尺度表示信號的平滑程度）和位置（表示信號的時域位置）。小波變換通過將信號與不同尺度的小波進行卷積，從而獲得信號在不同尺度下的表示。

小波變換可以分為兩種類型：

- **連續小波變換 (Continuous Wavelet Transform, CWT)**：在所有的尺度和位置上計算小波變換，生成連續的時頻表示。
- **離散小波變換 (Discrete Wavelet Transform, DWT)**：只在離散的尺度和位置上計算小波變換，生成離散的時頻表示。這種方法較為常用，並且具有較低的計算複雜度。

#### 2. 小波變換公式

假設有一個信號 \( f(t) \)，對其進行小波變換，得到小波係數 \( W(a, b) \)，公式為：

\[
W(a, b) = \int_{-\infty}^{\infty} f(t) \psi^* \left( \frac{t - b}{a} \right) dt
\]

其中：
- \( \psi(t) \)：母小波（mother wavelet），它是一個具有零均值和有限支持的函數。
- \( a \)：尺度參數，決定了小波的伸縮程度。
- \( b \)：位置參數，決定了小波的位置。
- \( \psi^*(t) \)：母小波的共軛。

這個公式表示將信號 \( f(t) \) 與縮放和位移過的母小波 \( \psi \) 進行卷積，從而獲得信號在各個尺度和位置上的特徵。

#### 3. 小波變換的應用

小波變換具有許多應用，尤其是在信號處理領域：

- **圖像處理**：小波變換常用於圖像壓縮（如JPEG 2000）、去噪和特徵提取等應用。通過小波變換，圖像可以被分解為多個尺度的表示，有助於捕捉圖像中的細節和結構。
- **音頻和語音處理**：小波變換對於音頻信號的多尺度分析非常有效。它能夠揭示出信號在不同時間和頻率範圍內的結構，對於音頻信號的去噪、語音識別等任務有重要作用。
- **生物信號處理**：在生物醫學領域，小波變換被廣泛應用於EEG（腦電圖）信號的分析、心電圖（ECG）信號的分析等。
- **數據壓縮**：小波變換在數據壓縮中也有應用，例如JPEG 2000圖像壓縮標準，就是基於離散小波變換。

#### 4. 小波變換的優勢

- **時頻局部性**：小波變換可以在不同尺度上分析信號的局部特徵，這使得它能夠比傅立葉變換更好地處理非平穩信號。
- **多解析度分析**：小波變換能夠提供信號在不同解析度下的表示，這對於多尺度的信號分析和處理非常有用。
- **去噪能力**：小波變換能夠有效地從信號中提取出重要特徵，並將噪聲分離，這使得它在去噪方面具有優勢。

#### 5. 小波變換的PyTorch實現

以下是利用PyTorch實現離散小波變換（DWT）的簡單範例：

```python
import torch
import matplotlib.pyplot as plt
import pywt

# 創建一個簡單的信號（正弦波 + 雜訊）
sampling_rate = 1000
duration = 1.0
frequency = 50
t = torch.linspace(0, duration, int(sampling_rate * duration), dtype=torch.float32)
signal = torch.sin(2 * torch.pi * frequency * t) + 0.5 * torch.randn_like(t)  # 加入雜訊

# 使用PyWavelets執行離散小波變換（DWT）
coeffs = pywt.wavedec(signal.numpy(), 'db1', level=5)  # 使用Daubechies 1小波進行5層分解

# 可視化原始信號與小波變換結果
fig, axs = plt.subplots(6, 1, figsize=(10, 8))

# 原始信號
axs[0].plot(t.numpy(), signal.numpy())
axs[0].set_title('Original Signal')

# 小波變換的每一層係數
for i in range(5):
    axs[i+1].plot(coeffs[i])
    axs[i+1].set_title(f'Wavelet Coefficients at Level {i+1}')

plt.tight_layout()
plt.show()
```

### 解釋：
1. **創建信號**：生成一個50 Hz的正弦波並加入一些隨機噪聲，構成一個較為複雜的信號。
2. **小波變換**：使用 `pywt.wavedec()` 函數進行離散小波變換（DWT），並選擇Daubechies 1（db1）小波進行5層分解。
3. **可視化**：繪製原始信號和小波變換結果，觀察每一層小波係數的變化。

### 小結

小波變換在處理多尺度信號時具有顯著優勢，特別是在信號的時頻分析中。與傅立葉變換相比，小波變換可以提供更多的局部化信息，使其對於音頻信號、圖像信號及生物信號的分析和處理非常有效。它的應用範圍十分廣泛，並且在信號去噪、數據壓縮等方面具有強大的能力。在PyTorch中，我們可以利用其他庫（如`pywt`）來輔助實現小波變換，並進行進一步的信號分析。