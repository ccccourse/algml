### 廣義線性模型 (Generalized Linear Models, GLM)

廣義線性模型（GLM）是一種統計模型，它將線性回歸模型的一些假設進行了擴展，並提供了一個統一的框架來處理各種不同類型的回歸問題，無論是連續型的還是類別型的響應變數。GLM的核心思想是將回歸模型的預測輸出（例如，期望值）與一個線性組合的變數相關聯，並通過一個鏈接函數來調整預測值的範圍和分佈。

GLM由三個組件組成：
1. **隨機組件 (Random Component)**：指定響應變數 \( y \) 的條件分佈。響應變數可以有不同的分佈，例如正態分佈、二項分佈、泊松分佈等。
2. **系統組件 (Systematic Component)**：指定解釋變數 \( \mathbf{x} \) 的線性組合。通常是形式為 \( \mathbf{x}^\top \beta \) 的線性組合。
3. **鏈接函數 (Link Function)**：定義了系統組件（即線性預測變數）和隨機組件（即響應變數的期望值）之間的關係。鏈接函數通常是單調且可微的。

### 1. **模型結構**

在GLM中，對於每個樣本 \( i \)，響應變數 \( y_i \) 的期望值 \( \mu_i = E[y_i | \mathbf{x}_i] \) 與輸入特徵向量 \( \mathbf{x}_i = (x_{i1}, x_{i2}, \dots, x_{in})^\top \) 的線性組合 \( \mathbf{x}_i^\top \beta \) 之間的關係是通過鏈接函數來定義的：

\[
g(\mu_i) = \mathbf{x}_i^\top \beta
\]

其中，\( g(\cdot) \) 是鏈接函數，將期望值 \( \mu_i \) 映射到線性預測變數的範圍。

不同的GLM對應於不同的隨機組件和鏈接函數，根據不同的響應變數分佈，鏈接函數會有所不同。

### 2. **常見的分佈和鏈接函數**

根據響應變數的分佈，GLM可以分為多種類型。以下是幾個常見的選擇：

#### 1. **線性回歸 (普通最小二乘法)**

- **隨機組件**：響應變數 \( y \) 服從正態分佈，\( y_i \sim N(\mu_i, \sigma^2) \)。
- **鏈接函數**：線性鏈接函數 \( g(\mu_i) = \mu_i \)。
- **系統組件**：線性組合 \( \mathbf{x}_i^\top \beta \)。
  
因此，這就回到了傳統的線性回歸模型，其中：

\[
y_i = \mathbf{x}_i^\top \beta + \epsilon_i
\]

其中 \( \epsilon_i \sim N(0, \sigma^2) \)。

#### 2. **邏輯迴歸 (Logistic Regression)**

- **隨機組件**：響應變數 \( y \) 服從二項分佈，\( y_i \sim \text{Binomial}(1, \mu_i) \)。
- **鏈接函數**：邏輯鏈接函數 \( g(\mu_i) = \log \left( \frac{\mu_i}{1 - \mu_i} \right) \)。
- **系統組件**：線性組合 \( \mathbf{x}_i^\top \beta \)。

對於二分類問題，邏輯迴歸的期望值 \( \mu_i \) 是類別為1的概率 \( P(y_i = 1) \)，可以表示為：

\[
\mu_i = \sigma(\mathbf{x}_i^\top \beta)
\]

其中 \( \sigma(z) = \frac{1}{1 + e^{-z}} \) 是邏輯函數。

#### 3. **泊松回歸 (Poisson Regression)**

- **隨機組件**：響應變數 \( y \) 服從泊松分佈，\( y_i \sim \text{Poisson}(\mu_i) \)。
- **鏈接函數**：對數鏈接函數 \( g(\mu_i) = \log(\mu_i) \)。
- **系統組件**：線性組合 \( \mathbf{x}_i^\top \beta \)。

泊松回歸用來建模計數數據，其中響應變數表示某個事件在某段時間內發生的次數。泊松分佈的期望值 \( \mu_i \) 是事件發生的頻率。

\[
\mu_i = e^{\mathbf{x}_i^\top \beta}
\]

#### 4. **高斯過程回歸 (Gaussian Process Regression)**

- **隨機組件**：響應變數服從高斯分佈，\( y_i \sim \mathcal{N}(\mu_i, \sigma^2) \)。
- **鏈接函數**：根據需求選擇，通常是線性或非線性鏈接。
- **系統組件**：高斯過程模型中，系統組件表示為特徵空間中函數的線性組合。

### 3. **最大似然估計**

對於GLM的估計，常用的推斷方法是最大似然估計（Maximum Likelihood Estimation, MLE）。最大似然估計方法尋找一組模型參數 \( \beta \)，使得在觀察到的數據下，響應變數的似然函數最大。對於每個模型，我們將響應變數的條件分佈（隨機組件）與鏈接函數結合，然後最大化對數似然函數。

在一般情況下，對數似然函數為：

\[
\mathcal{L}(\beta) = \sum_{i=1}^m \log P(y_i | \mathbf{x}_i; \beta)
\]

最大化對數似然函數，通常通過梯度下降等優化方法進行。

### 4. **優點與應用**

- **靈活性**：GLM提供了一個靈活的框架，能夠處理各種類型的響應變數，從連續數據到計數數據，再到類別數據。
- **解釋性**：GLM模型中的回歸係數 \( \beta \) 具有較強的解釋性，可以直接表示輸入特徵對響應變數的影響。
- **廣泛應用**：GLM在很多領域中有廣泛的應用，如醫學研究（預測疾病發生概率）、市場營銷（預測客戶購買行為）、金融風險建模等。

### 5. **總結**

廣義線性模型（GLM）是一個統一的框架，用於處理各種類型的回歸問題，包括線性回歸、邏輯迴歸、泊松回歸等。它通過鏈接函數將線性預測與不同的響應變數分佈相結合。GLM的主要優點是其靈活性和強大的建模能力，並且可以使用最大似然估計進行參數估計，這使其成為統計學和機器學習中的重要工具。