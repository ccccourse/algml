### 擬牛頓法 (Quasi-Newton Methods)

擬牛頓法是一類不需要顯式計算Hessian矩陣的二階優化方法。它通過迭代更新Hessian矩陣的近似，來避免直接計算Hessian及其逆矩陣的高計算成本。與牛頓法相比，擬牛頓法既保持了二階方法的優勢，又避免了計算和存儲大規模Hessian矩陣的問題。

#### 1. **基本思想**

擬牛頓法的目標是估計目標函數的Hessian矩陣 \( H \)，而不是直接計算它。為了做到這一點，擬牛頓法根據當前的梯度信息（和先前的更新步長）來迭代更新Hessian矩陣的近似。這樣的近似可以提供比一階方法更精確的更新方向，從而加速優化過程。

#### 2. **更新規則**

擬牛頓法的核心是更新一個對Hessian矩陣 \( H_k \) 的近似值，並且不顯式計算目標函數的Hessian。更新規則通常基於以下兩條基本關係：
1. 目標函數梯度的變化：\( \nabla f(x_{k+1}) - \nabla f(x_k) \)
2. 參數的變化：\( x_{k+1} - x_k \)

具體來說，擬牛頓法的更新公式可以寫成：
\[
H_{k+1} = H_k + \frac{y_k y_k^T}{y_k^T s_k} - \frac{H_k s_k s_k^T H_k}{s_k^T H_k s_k},
\]
其中：
- \( s_k = x_{k+1} - x_k \) 是參數的變化，
- \( y_k = \nabla f(x_{k+1}) - \nabla f(x_k) \) 是梯度的變化。

這樣的更新公式保證了每一步的Hessian近似都符合某些最小化的條件。

#### 3. **擬牛頓法的變種**

- **BFGS（Broyden–Fletcher–Goldfarb–Shanno）方法**：
  BFGS是最常見且廣泛使用的擬牛頓法。BFGS方法通過上述公式不斷地更新Hessian的逆矩陣（而不是Hessian本身），從而避免了對Hessian矩陣的顯式求逆。BFGS的更新公式如下：
  \[
  B_{k+1} = B_k + \frac{y_k y_k^T}{y_k^T s_k} - \frac{B_k s_k s_k^T B_k}{s_k^T B_k s_k},
  \]
  其中 \( B_k \) 是Hessian矩陣的逆，這個方法有效減少了內存使用並且提高了運算效率。

- **L-BFGS（Limited-memory BFGS）**：
  L-BFGS是BFGS的一個變種，旨在解決高維問題中的存儲問題。L-BFGS並不存儲完整的Hessian逆矩陣，而是僅保存最近的幾個梯度變化和參數變化，這使得它能夠在內存使用上更加高效。這使得L-BFGS在大規模優化問題中非常受歡迎。

- **DFP（Davidon–Fletcher–Powell）方法**：
  DFP是另一種擬牛頓法，它使用與BFGS相似的思想來更新Hessian矩陣的近似值，但它的更新公式與BFGS不同。DFP方法的更新公式是：
  \[
  H_{k+1} = H_k + \frac{y_k y_k^T}{y_k^T s_k} - \frac{H_k s_k s_k^T H_k}{s_k^T H_k s_k}.
  \]
  雖然DFP在理論上具有良好的性能，但在實際應用中，BFGS方法通常比DFP方法更常用。

#### 4. **優點**

- **計算效率**：擬牛頓法相比於牛頓法，避免了直接計算和存儲Hessian矩陣的成本，因此在計算效率上有明顯優勢。
- **收斂性**：擬牛頓法在具有良好曲率結構的問題中，比一階方法（如梯度下降）具有更好的收斂速度，尤其是在接近最優解時。
- **適用於大規模問題**：L-BFGS等變種能夠有效地應用於大規模優化問題，因為它們只需要儲存和處理梯度信息，而不需要儲存整個Hessian矩陣。

#### 5. **缺點**

- **內存需求**：雖然L-BFGS減少了存儲需求，但標準BFGS和DFP方法仍然需要存儲整個Hessian矩陣，這在高維度問題中可能會佔用大量內存。
- **對初始點敏感**：擬牛頓法仍然可能對初始點選擇較為敏感，尤其是對於非凸問題，可能會陷入局部最小值或鞍點。
- **計算成本**：儘管擬牛頓法比牛頓法計算量小，但它仍然需要計算和儲存梯度信息，這在一些情況下可能會對計算時間產生影響。

#### 6. **應用場景**

- **機器學習與深度學習**：擬牛頓法，尤其是L-BFGS，經常用於訓練較小規模的機器學習模型，尤其是需要精確優化的場景。BFGS則常用於相對較小規模的問題，尤其是當模型需要較高精度時。
- **數值優化**：擬牛頓法被廣泛應用於各類數值優化問題，特別是在無約束優化或有簡單約束的情況下。

#### 7. **數學分析**

擬牛頓法的數學核心在於通過某些假設來有效更新Hessian的近似。這些假設使得每次更新都能更好地匹配目標函數的曲率，並且可以在不需要完全存儲和計算Hessian的情況下提供較快的收斂。儘管如此，擬牛頓法的收斂性通常比牛頓法慢，但仍然比一階方法快，並且具有更好的穩定性。

#### 8. **總結**

擬牛頓法提供了牛頓法的優勢，並通過避免顯式計算Hessian矩陣來降低計算和存儲的成本。它在許多優化問題中都表現出了良好的性能，並且對於需要高效計算的大規模問題來說，L-BFGS變種是非常有效的選擇。然而，擬牛頓法仍然存在對初始點的敏感性和對非凸問題可能不收斂的問題。因此，在使用擬牛頓法時，通常需要仔細選擇初始化策略並監控收斂行為。