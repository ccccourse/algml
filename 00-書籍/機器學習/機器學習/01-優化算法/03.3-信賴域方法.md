### 信賴域方法 (Trust-Region Methods)

信賴域方法是一類二階優化算法，用於無約束優化問題，特別適用於目標函數形狀複雜或不光滑的情況。這些方法在每一步迭代中，限制了搜索範圍（即信賴域），而不是在整個可行域中進行無限制的搜索。信賴域方法通常能提供更穩定和高效的收斂，尤其是在問題的二階導數信息可用時。

#### 1. **基本概念**

信賴域方法的核心思想是，在每次迭代中，根據當前點的函數值和梯度信息來選擇一個有限的區域（信賴域），並在該區域內對目標函數進行近似。與其直接沿著最速下降方向（如梯度下降法），信賴域方法會構造一個簡化的模型來進行預測，然後根據該模型選擇最合適的步長和方向。

在信賴域方法中，選擇的步長大小通常受限於信賴域的半徑，這樣避免了過大的步長可能導致的不穩定行為。信賴域方法可以分為以下幾個步驟：

1. **建立模型**：對於當前的點，通常使用二階泰勒展開或擬牛頓方法來構造目標函數的近似模型。
2. **求解模型**：在信賴域內解這個簡化模型，以確定合適的步長。
3. **接受或拒絕步長**：根據模型的預測誤差來決定是否接受這個步長。如果預測誤差過大，則縮小信賴域；如果誤差較小，則增大信賴域。

#### 2. **數學模型與算法**

對於目標函數 \( f(x) \)，信賴域方法在每一步中會解一個簡化的模型，通常選擇二階泰勒展開來近似原始目標函數。設 \( x_k \) 是當前的點，則在 \( x_k \) 附近的目標函數可以近似為：

\[
m_k(s) = f(x_k) + \nabla f(x_k)^T s + \frac{1}{2} s^T B_k s,
\]
其中 \( s \) 是步長，\( B_k \) 是 \( f(x) \) 的近似Hessian矩陣，通常選擇為 \( B_k = \nabla^2 f(x_k) \) 或者通過擬牛頓方法進行近似。

在這裡，信賴域的大小由 \( \Delta_k \) 限制，即 \( \| s \| \leq \Delta_k \)，其中 \( \Delta_k \) 是信賴域的半徑。接下來的步驟包括：

1. **求解子問題**：在信賴域內最小化模型 \( m_k(s) \)，即：
   \[
   \min_{s} m_k(s) \quad \text{subject to} \quad \| s \| \leq \Delta_k.
   \]
   求解該子問題得到步長 \( s_k^* \)。

2. **更新信賴域半徑**：根據模型的預測誤差來更新信賴域的半徑。如果預測誤差小，則增大 \( \Delta_k \)，反之則縮小。

3. **接受步長**：根據實際目標函數和模型的比較，決定是否接受步長 \( s_k^* \)。如果實際下降值與模型預測接近，則步長被接受，並增加信賴域大小；如果預測不準確，則步長被拒絕，並縮小信賴域。

#### 3. **步驟詳解**

- **模型的構建**：根據當前點 \( x_k \)，使用泰勒展開或擬牛頓方法構造一個簡化的二次模型。這個模型是目標函數在當前點的局部近似，描述了目標函數在信賴域內的變化趨勢。
  
- **子問題求解**：這一步是信賴域方法的核心，目的是在信賴域內解最小化問題。該問題通常是求解一個受限的二次優化問題，這是通過優化二階泰勒展開得到的模型來實現的。這一步的難度取決於模型的複雜度和信賴域的大小。

- **步長更新**：根據模型預測的誤差來決定步長的接受條件。如果模型誤差較小，則步長被接受並更新當前點。如果模型誤差較大，則步長被拒絕，信賴域半徑會縮小，並且會重新調整步長。

#### 4. **信賴域方法的數學細節**

信賴域方法的一個關鍵概念是**實際減少**和**預測減少**之間的比較。假設模型預測的步長為 \( s_k^* \)，模型的預測減少為 \( \Delta_m \)，而實際的減少為 \( \Delta_f \)，則根據預測減少和實際減少之比來決定是否接受步長。如果這個比率大於某個閾值，則增大信賴域半徑；否則縮小信賴域。

- **預測減少**：
  \[
  \Delta_m = f(x_k) - f(x_k + s_k^*).
  \]
- **實際減少**：
  \[
  \Delta_f = f(x_k) - f(x_k + s_k).
  \]
  
根據這些比較，信賴域方法決定是否進行信賴域的調整。

#### 5. **優點**

- **穩定性**：由於每次更新都受到信賴域半徑的限制，這使得信賴域方法比純粹的梯度下降法更為穩定，尤其是在目標函數具有顯著非線性或不光滑的情況下。
- **高效性**：在大多數情況下，信賴域方法能夠提供比單純的一階方法（如梯度下降）更快的收斂速度，特別是在涉及到二階信息的問題中。
- **適用範圍廣泛**：信賴域方法對於很多類型的優化問題都有良好的性能，特別是在Hessian矩陣可計算或可以被擬合的情況下。

#### 6. **缺點**

- **計算成本**：每一步都需要解決一個受限的二次優化子問題，這可能需要較多的計算時間，特別是當問題規模較大時。
- **收斂速度**：雖然信賴域方法在大多數情況下收斂較快，但在某些情況下，對於非凸問題，其收斂速度可能較慢，並且可能會遭遇局部最優解。

#### 7. **應用場景**

信賴域方法廣泛應用於各種優化問題，包括：
- **非線性最小化問題**，特別是那些不光滑或有不規則變化的目標函數。
- **機械學習中的參數調整**，特別是當目標函數具有複雜的二階結構時。
- **工程設計優化**，如結構設計、航空航天、製造過程中的設計優化問題。

#### 8. **總結**

信賴域方法是一種強大的二階優化技術，通過限制每次迭代的步長範圍來提高優化過程的穩定性和收斂速度。它不僅在理論上具有較強的收斂性，實際上也在許多大規模優化問題中提供了顯著的效益。然而，由於計算成本較高，信賴域方法的應用範圍會根據具體問題的需求有所不同。