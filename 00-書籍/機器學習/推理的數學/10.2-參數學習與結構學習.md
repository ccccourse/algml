### 參數學習與結構學習

在貝葉斯網絡的應用中，除了推理外，參數學習和結構學習是兩個至關重要的步驟。參數學習旨在從數據中估計貝葉斯網絡中隨機變量的條件概率分佈（即CPT），而結構學習則是決定網絡的結構，即隨機變量之間的依賴關係。這兩者通常是模型構建過程中的重要環節，並且能夠顯著影響貝葉斯網絡的效果與準確性。

#### 1. **參數學習**

參數學習的目的是估計每個節點的條件概率分佈，這些條件概率分佈基於網絡結構中的父節點。因此，參數學習的核心問題是如何根據觀察數據來估算條件概率表（CPT）。

**數學表示**：
對於一個具有父節點 \( \text{Pa}(X_i) \) 的隨機變量 \( X_i \)，其條件概率 \( P(X_i | \text{Pa}(X_i)) \) 可以使用最大似然估計（Maximum Likelihood Estimation, MLE）或貝葉斯估計來估算。假設我們有一組觀察數據 \( D = \{ X_1, X_2, \dots, X_n \} \)，並且這些數據來自於 \( P(X_1, X_2, \dots, X_n) \)，則條件概率表 \( P(X_i | \text{Pa}(X_i)) \) 可以通過最大化以下似然函數來估算：
\[
\mathcal{L} = \prod_{j=1}^m P(X_i^{(j)} | \text{Pa}(X_i^{(j)}))
\]
其中 \( X_i^{(j)} \) 表示第 \( j \) 筆數據的隨機變量值，\( \text{Pa}(X_i^{(j)}) \) 表示對應的父節點值。最大化這個似然函數可以得到條件概率表的估計值。

**方法**：
- **最大似然估計（MLE）**：當數據量較大且不涉及先驗知識時，常用最大似然估計方法，通過觀察數據來直接估算條件概率。
- **貝葉斯估計**：當數據量較小或我們需要結合先驗知識時，可以使用貝葉斯估計來更新條件概率。貝葉斯估計在最大似然估計的基礎上引入先驗分佈，通過貝葉斯定理更新後驗分佈。

#### 2. **結構學習**

結構學習是指在不預先指定貝葉斯網絡結構的情況下，根據觀察數據學習隨機變量之間的依賴關係。由於貝葉斯網絡的結構在某些應用中是未知的，結構學習的目標是自動發現這些依賴關係，進而構建網絡的有向無環圖（DAG）。

結構學習的主要挑戰在於如何選擇最佳的結構，即決定哪些變量之間存在邊，以及邊的方向。這一問題是NP困難的，因為隨著變量數量的增多，所有可能的結構組合將指數性增長。

**方法**：
- **搜尋法（Search Methods）**：
  - **貝葉斯信息準則（BIC）**：一種常見的結構選擇標準，是基於模型的似然度和模型複雜度之間的平衡。BIC可以幫助在大量的候選結構中選擇出最優結構。
  - **逐步搜尋（Greedy Search）**：從初始結構開始，逐步修改網絡結構以提高模型的適配度，通常使用局部搜索策略。這樣的方法有助於在較大範圍的結構空間中找到一個近似最優解。
  - **全局搜尋（Global Search）**：例如基於蒙特卡羅方法的全局優化策略，可以探索所有可能的結構，雖然計算量大，但可以保證找到全局最優解。

- **結構學習算法**：
  - **贖回法（Score-based Methods）**：根據數據計算某個結構的分數，然後選擇最佳結構。這種方法基於分數函數（如BIC或AIC）來評估結構的好壞。
  - **約束法（Constraint-based Methods）**：此方法基於統計依賴性測試（例如，條件獨立性測試）來推斷網絡結構。它通過反覆測試隨機變量之間的依賴關係，逐步建立結構。
  - **混合方法（Hybrid Methods）**：結合贖回法和約束法的優勢，根據統計依賴測試和模型分數進行結構學習。

**結構學習的步驟**：
1. **數據預處理**：準備包含隨機變量的觀察數據。
2. **獲取初步結構**：使用基於約束的算法或初始化的隨機結構。
3. **結構評估與優化**：基於選定的評價標準對結構進行評估，並根據算法優化結構。
4. **模型驗證與調整**：對學習得到的結構進行驗證，確保其能夠正確地反映數據中的隨機變量依賴關係。

#### 3. **結構學習與參數學習的關係**

結構學習和參數學習密切相關。參數學習通常在結構確定後進行，即在已經確定了隨機變量之間的依賴關係後，對條件概率表進行估算。而結構學習則是先行步驟，它決定了哪些變量之間應該存在邊，並且指導參數學習的進行。

然而，在某些情況下，結構學習和參數學習可以交替進行，這種方法稱為**EM算法（Expectation-Maximization）**。在EM算法中，結構和參數的學習過程是交替的，直到收斂。

#### 4. **結論**

參數學習和結構學習是貝葉斯網絡模型的核心部分，兩者互為依賴並且共同作用於模型的建立。參數學習從數據中估計條件概率，而結構學習則是根據數據推斷隨機變量之間的依賴關係。隨著學習算法的發展，結構學習和參數學習的效率和準確性得到了顯著提升，並且這些方法在多領域的應用中發揮了關鍵作用，尤其是在智能系統、醫學診斷、金融預測等領域。