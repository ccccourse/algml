### **磁碟中的搜尋與排序**

在磁碟存取的上下文中，搜尋和排序操作是為了在大量資料中高效查找和管理檔案，尤其是當資料量超過可用記憶體時，磁碟的搜尋和排序變得至關重要。磁碟存儲通常比記憶體慢得多，因此，必須設計能夠最小化磁碟存取次數的算法。常見的搜尋與排序方法包括基於索引結構（如B樹）和外部排序技術。

### **1. 磁碟搜尋**

磁碟上的搜尋通常基於資料結構如B樹或哈希表，這些結構能有效地管理大量資料並加速查找過程。

#### **(1) B樹搜尋**

B樹是一種自平衡的多路搜尋樹，非常適合用於檔案系統中，因為它能夠高效地在磁碟上進行搜尋。B樹儲存資料的方式使得每個節點包含多個鍵和指針，這樣在搜尋時能夠儘量減少磁碟存取次數。

- **操作**：當使用B樹搜尋時，系統從樹的根開始，根據鍵值進行比較，然後逐步下降至葉節點。每次比較後，根據比較結果選擇適當的子節點進行搜尋。
- **優點**：B樹高度平衡，搜尋的時間複雜度為O(log n)，能夠有效地處理大量資料。
- **磁碟存取**：由於B樹的節點通常設計為可以適應磁碟頁面的大小，這樣可以在單次磁碟存取中讀取更多資料，降低I/O成本。

#### **(2) 哈希表搜尋**

哈希表也可以用於檔案系統的搜尋，尤其是當資料分布不均時，哈希表可以提供接近O(1)的平均查找時間。當使用哈希表時，檔案名稱或其他檔案屬性會被映射到一個哈希值，這個哈希值指向資料存儲位置。

- **優點**：查找速度快，接近常數時間O(1)。
- **缺點**：需要處理哈希碰撞，且在某些情況下，哈希表的大小需要動態調整。
- **磁碟存取**：哈希表中的槽位可以存儲在磁碟中，雖然哈希表通常需要多次I/O存取，但仍比線性搜尋要高效。

### **2. 磁碟排序**

在磁碟上進行排序時，主要的挑戰在於如何有效地處理大規模資料集，這些資料集無法完全載入記憶體中。外部排序是一種專門為此類情況設計的排序方法。

#### **(1) 外部排序（External Sorting）**

外部排序是一種針對磁碟存儲設計的排序方法，通常用於處理大於記憶體大小的資料。這種方法的核心是將資料分割成較小的區塊，分別排序後再進行合併。最常見的外部排序算法是**歸併排序（Merge Sort）**。

- **步驟**：
  1. **分割階段**：將大資料集分割成多個較小的部分，每個部分足夠小，可以載入記憶體中。
  2. **排序階段**：在記憶體中對每個分割的小部分進行排序，通常使用快速排序、插入排序等內部排序算法。
  3. **合併階段**：將排序好的小部分合併成一個完整的有序資料集。合併操作通常使用歸併排序，它將多個排序好的檔案區塊逐一合併，並以最小的排序成本將結果寫回磁碟。

- **優點**：能夠處理大規模的資料集，並且將磁碟存取的次數降至最低。
- **缺點**：合併階段需要較多的I/O操作，因此磁碟的存取效能依賴於磁碟的速度以及排序的區塊大小。

#### **(2) 多路歸併排序（k-way Merge Sort）**

多路歸併排序是外部排序的一種變體，當有多個排序好的資料區塊時，它會將多個區塊進行合併。這個方法利用了最小堆（Min-Heap）來加速多路合併過程，減少磁碟存取次數。

- **操作**：將k個已排序的區塊的指針放入最小堆中，每次從堆中取出最小元素，並將對應區塊中的下一個元素插入堆中。
- **優點**：減少磁碟I/O操作，對於磁碟存儲的資料進行高效合併。

### **總結**

在磁碟存取的情境下，搜尋和排序的目標是最小化磁碟I/O操作。常見的搜尋方法如B樹和哈希表能夠提高搜尋效率，而外部排序則能夠有效地處理超過記憶體容量的大規模資料集。歸併排序和多路歸併排序是磁碟排序的主要技術，專門為解決磁碟資料排序問題而設計，能夠高效地處理大量資料。