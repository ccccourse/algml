
## em_coin.py

User 請另外舉一個 EM 演算法的範例，然後用 python 實作出來

使用 ChatGPT 成功案例

* https://chat.openai.com/share/43b644e1-c404-4873-b2df-f8815461670e

ChatGPT

好的，我将为你提供一个简单的 EM 演算法的例子。我们考虑一个有两个硬币的模型，每个硬币正面出现的概率不同。我们有一组观测数据，但我们不知道每次观测使用的是哪个硬币。

问题描述：

    有两个硬币，硬币1正面出现的概率为θ1，硬币2正面出现的概率为θ2，每次观测到正面记为1，观测到反面记为0。我们有一组观测数据，但每次观测到的是哪个硬币不可见。

模型参数：

    隐变量：硬币的选择（z=1表示选择硬币1，z=0表示选择硬币2）
    观测变量：每次观测到的结果（x=1表示正面，x=0表示反面）

模型参数：

    初始硬币选择的概率：P(z=1)
    每个硬币正面出现的概率：P(x=1 | z=1), P(x=1 | z=0)

```
$ python em_coin.py
迭代次数: 2
初始选择硬币的概率: 0.5060606060606063
硬币1正面出现的概率: 0.6191616766467065
硬币2正面出现的概率: 0.31717791411042945
```

## em_gauss.py

User
    再舉一個不同的例子，一樣用 python 實作

ChatGPT
    好的，让我们考虑一个混合高斯模型的例子。在这个例子中，我们有两个高斯分布的混合物，每个高斯分布有自己的均值和方差。我们观察到一组数据，但不知道每个观测点属于哪个分布。我们可以使用 EM 算法来估计混合高斯模型的参数。

问题描述：

    有两个高斯分布，分别由参数 (μ1, σ1^2) 和 (μ2, σ2^2) 描述。每次观测到的数据点属于其中一个高斯分布，但我们无法观察到每个数据点的真实来源。

模型参数：

    隐变量：观测数据点的来源（z=1表示来自第一个高斯分布，z=0表示来自第二个高斯分布）
    观测变量：观测到的数据点

```
$ python em_gauss.py
迭代次数: 68
混合系数: 0.36776487873791086
第一个高斯分布的均值和方差: 4.848838980989098 0.8931407458661573
第二个高斯分布的均值和方差: 9.89103564251239 2.2076849364938105
```

## em_corel.py

```
$ python em_corel.py
迭代次数: 36
混合系数: 0.3181822278114451
协方差矩阵: [[5.99069626 6.61799565]
 [6.61799565 9.14947125]]
```

## em_normal.py





User
    再舉一個不同的例子，一樣用 python 實作
    
ChatGPT
    让我们考虑一个简单的例子，假设我们有一组包含两个成分的数据，但我们不知道每个数据点属于哪个成分。我们可以使用 EM 算法来估计这两个成分的均值。

问题描述：

    有两个成分，每个成分由均值μ和标准差σ描述。我们观测到一组数据，但不知道每个数据点属于哪个成分。

模型参数：

    隐变量：每个观测数据点属于哪个成分（z=1表示属于第一个成分，z=0表示属于第二个成分）
    观测变量：观测到的数据点

```
$ python em_normal.py
迭代次数: 22
混合系数: 0.4883260322041784
第一个成分的均值: 5.33347273549885
第二个成分的均值: 10.616563596776396
```

## em_normal2.py

User
再舉一個完全不同的例子，一樣用 python 實作

ChatGPT
    让我们考虑一个简单的例子，假设我们有一组包含两个群体的数据，每个群体的分布不同。我们可以使用 EM 算法来估计每个群体的分布参数。

问题描述：

    有两个群体，每个群体由均值μ和标准差σ描述。我们观测到一组数据，但不知道每个数据点属于哪个群体。

模型参数：

    隐变量：每个观测数据点属于哪个群体（z=1表示属于第一个群体，z=0表示属于第二个群体）
    观测变量：观测到的数据点

## em_markov.py

失敗案例

* https://chat.openai.com/share/43b644e1-c404-4873-b2df-f8815461670e

```
$ python em_markov.py
Traceback (most recent call last):
  File "D:\ccc\ccc112a\py2cs\02-演算法\02-方法\09b-蒙地卡羅法\08b-emChat\em_markov.py", line 42, in <module>
    new_transition_prob = np.dot(state_prob_given_observation.T, transition_prob.T) / np.sum(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<__array_function__ internals>", line 180, in dot
ValueError: shapes (2,5) and (2,2) not aligned: 5 (dim 1) != 2 (dim 0)
```