### 第七章：時序分析與優化  

#### 7.1 靜態時序分析算法  
- **靜態時序分析（Static Timing Analysis, STA）概述**  
  - **目標**：確保電路在目標時鐘頻率下穩定工作，驗證所有信號路徑是否滿足時序要求。  
  - **核心概念**：  
    - **關鍵路徑**：延遲最大的信號路徑，決定了電路的最小時鐘周期。  
    - **時序邊界**：建立時序（setup time）和保持時序（hold time）。  

- **算法步驟**  
  1. **拓撲排序**：對電路網表進行拓撲排序，確定信號的訪問順序。  
  2. **前向分析**：計算信號到達時間（Arrival Time, AT）。  
  3. **後向分析**：計算信號所需時間（Required Arrival Time, RAT）。  
  4. **時序餘量計算**：  
     - **餘量（Slack）**：  
       \( \text{Slack} = \text{RAT} - \text{AT} \)  
       Slack 為負表示不滿足時序需求。  
  5. **報告生成**：輸出所有關鍵路徑及其時序餘量，定位需要優化的區域。  

- **特性**：  
  - STA 基於邏輯網表與時序約束，不依賴模擬向量，效率高且適用於大規模設計。  

#### 7.2 時序驅動的佈局布線  
- **概述**  
  - 傳統佈局與布線僅關注面積與連接，時序驅動則進一步優化信號路徑的延遲與完整性。  

- **方法**  
  1. **時序感知佈局**：  
     - 在模組放置階段引入時序優化目標，縮短關鍵路徑的物理距離，減小信號延遲。  
     - 考慮時序敏感度的成本函數：  
       \( \text{Cost} = \text{Wirelength} + \lambda \times \text{Slack Penalty} \)  
       其中，\(\lambda\) 為權重因子。  

  2. **時序感知布線**：  
     - 關鍵路徑優先布線，採用高性能布線層以降低 RC 延遲。  
     - 根據 STA 分析結果，調整信號的過孔與布線寬度以減少負載與串擾。  

- **應用場景**：  
  - 高性能處理器與數據中心晶片，需達到極低延遲目標。  

#### 7.3 緩衝插入與時序修復  
- **信號延遲的成因**  
  - 電阻（R）與電容（C）的 RC 乘積是信號延遲的主要原因。隨著布線長度增加，RC 延遲顯著增大，特別是關鍵路徑上的信號。  

- **緩衝插入（Buffer Insertion）**  
  - **目標**：通過在長布線上插入驅動能力更強的緩衝器，減少 RC 延遲。  
  - **基本策略**：  
    1. 將布線劃分為多段，每段長度控制在延遲可接受範圍內。  
    2. 在每段終點插入適當的緩衝器，確保信號完整性。  
  - **挑戰**：  
    - 平衡緩衝器數量與功耗開銷。  
    - 避免過多的緩衝器導致佈局擁擠。  

- **時序修復方法**  
  1. **增益調整**：在敏感區域中選擇更高驅動能力的標準單元替換現有單元。  
  2. **路徑重整**：對時序違規的路徑進行重布線，縮短物理距離。  
  3. **插入寄存器**：將超長路徑拆分為多個小段，增加暫存器以實現分段傳輸。  

- **工具與應用**  
  - 商業 EDA 工具（如 Synopsys PrimeTime、Cadence Innovus）能自動完成緩衝插入與路徑優化，特別適用於高性能設計中的時序修復。  

---

本章介紹了時序分析的核心方法、如何將時序要求引入佈局與布線過程，以及在設計後期進行時序優化的具體技術，為實現性能與穩定性兼備的設計提供了關鍵支持。
